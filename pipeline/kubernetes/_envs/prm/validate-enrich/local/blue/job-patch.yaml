apiVersion: flink.apache.org/v1beta1
kind: FlinkDeployment
metadata:
  name: flink-job
spec:
  job:
    args: [
      "--jobLabel=blue",
      "--parallelism=3",
      "--maxParallelism=120",
      "--checkpointInterval=PT1M",
      "--minPauseBetweenCheckpoints=10000", # 10 s minimum interval
      "--watermarkIdleness=PT3M",

      # Kafka configs
      "--startFromEarliest",

      "--paimonBasePath=s3a://promoted-event-logs/",
      "--no-disableAutoGeneratedUIDs",
      "--databaseName=raw",
      "--sideDatabaseName=raw_side",
    ]
  flinkConfiguration:
    taskmanager.numberOfTaskSlots: "3"
    state.savepoints.dir: s3a://promoted-event-logs/validate-enrich-flink-job-blue/savepoints
    state.checkpoints.dir: s3a://promoted-event-logs/validate-enrich-flink-job-blue/checkpoints
    high-availability.storageDir: s3a://promoted-event-logs/validate-enrich-flink-job-blue/ha
